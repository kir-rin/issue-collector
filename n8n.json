{
  "name": "My workflow",
  "nodes": [
    {
      "parameters": {
        "jsCode": "let markdwon_list = [];\n\nconst issues = $input.first().json.data.repository.issues.nodes;\n\nfor (let i = 0; i < issues.length; i++) {\n  const issue = issues[i];\n  if (!issue.author?.login) continue;\n  \n  const comments_text = issue.comments?.nodes.length ? issue.comments.nodes.map(c => `- ${c.body}`).join('\\n') : \"NA\";\n  const labels_text = issue.labels.edges.length ? issue.labels.edges.map(edge => edge.node.name).join(\",\") : \"NA\";\n  const issue_type = issue.issueType ?? \"NA\";\n  \n  markdwon_list.push(`\n    ## Issue ${i}\n    **Title**: ${issue.title}\n    **Type**: ${issue_type}\n    **Labels**: ${labels_text}\n    **Body**: ${issue.body}\n    **Comments**: ${comments_text}\n    **URL**: ${issue.url}\n  `)\n}\n\nreturn {\n  markdown_list: markdwon_list.join('\\n')\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        112,
        1104
      ],
      "id": "99abf255-7f65-4772-8bf1-90cf499a0b65",
      "name": "Convert Markdown"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -560,
        1104
      ],
      "id": "9d915cd3-9077-4308-b9f0-b6fc759c1441",
      "name": "When clicking ‚ÄòExecute workflow‚Äô"
    },
    {
      "parameters": {
        "jsCode": "const YAML = require('yaml');\nlet response = $input.first().json.output;\nlet responseText = response\n        .replace(/^(\\n)+/, '')\n        .replace(/^yaml/, '')\n        .replace(/^```yaml/, '')\n        .trimEnd()\n          .replace(/```$/, '');\n$input.first().json = YAML.parse(responseText, options={uniqueKeys: false}); \nreturn $input.first();"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        688,
        1104
      ],
      "id": "e1518ba9-818c-4a1f-877a-f773dad50ee1",
      "name": "parse YAML",
      "executeOnce": false,
      "retryOnFail": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "const createBulletedList = (items) => {\n      if (!Array.isArray(items) || items.length === 0) {\n          return '';\n      }\n      return items.map(item => `<mj-text mj-class=\"section-content\">‚Ä¢ ${item}</mj-text>`).join('<br/>');\n  };\n\n  let summary = `\n      <mj-section padding=\"15px\">\n          <mj-column border=\"1px solid #dddddd\" background-color=\"#FCF0D2\">\n              <mj-text mj-class=\"section-title\">üìå Quick Summary</mj-text>\n              ${createBulletedList($('parse YAML').first().json.summary)}\n          </mj-column>\n      </mj-section>`;\n\n  let issues = [];\n  const suitabilityOrder = { 'high': 0, 'medium': 1, 'low': 2 };\n  const difficultyOrder = { 'low': 0, 'medium': 1, 'high': 2 };\n\n  const sortedIssues = $('parse YAML').first().json.issues.sort((a, b) => {\n      const suitabilityA = suitabilityOrder[a.issueSuitability.level];\n      const suitabilityB = suitabilityOrder[b.issueSuitability.level];\n      if (suitabilityA !== suitabilityB) {\n          return suitabilityA - suitabilityB;\n      }\n      const difficultyA = difficultyOrder[a.technicalDifficulty.level];\n      const difficultyB = difficultyOrder[b.technicalDifficulty.level];\n      return difficultyA - difficultyB;\n  }).slice(0, 5);\n\n  for (const issue of sortedIssues) {\n      let issueInfo = `<mj-text mj-class=\"issue-title\">${issue.issueTitle}</mj-text>\n                      <mj-spacer/>\n                      <mj-text mj-class=\"section-title\">üßæ Issue Description</mj-text>\n                      <mj-text mj-class=\"section-content\">${issue.issueDescription}</mj-text>\n                      <mj-text mj-class=\"section-title\">üß© Root Cause</mj-text>\n                      <mj-text mj-class=\"section-content\">${issue.rootCause}</mj-text>`;\n      let resolutionApproach = `<mj-text mj-class=\"section-title\">üõ†Ô∏è Resolution Approach</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`;\n      resolutionApproach += createBulletedList(issue.resolutionApproach);\n      resolutionApproach += '</mj-text>';\n      \n      let issueSuitability = `<mj-text mj-class=\"section-title\">‚úÖ Issue Suitability: ${issue.issueSuitability.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n      issueSuitability += createBulletedList(issue.issueSuitability.reasons);\n      issueSuitability += '</mj-text>';\n      \n      let technicalDifficulty = `<mj-text mj-class=\"section-title\">üßó Technical Difficulty: ${issue.technicalDifficulty.level}</mj-text><mj-text font-size=\"14px\" line-height=\"1.6\">`\n      technicalDifficulty += createBulletedList(issue.technicalDifficulty.reasons);\n      technicalDifficulty += '</mj-text>';\n\n      let issuelink = `<mj-text mj-class=\"section-title\"><p>üëâ Go to Issue <a href=\"${issue.issueURL}\">(Link)</a></p></mj-text>`;\n\n      issues.push(issueInfo + resolutionApproach + issueSuitability + technicalDifficulty + issuelink)\n  }\n\n  return {\n      issueHTML: `\n          <mjml>\n\t\t\t<mj-head>\n                  <mj-attributes>\n                      <mj-class name=\"issue-title\" font-size=\"22px\" />\n                      <mj-class name=\"section-title\" font-size=\"15px\" font-weight=\"bold\"/>\n                      <mj-class name=\"section-content\" font-size=\"14px\" line-height=\"1.6\"/>\n                  </mj-attributes>\n              </mj-head>\n              <mj-body>\n                  <mj-section>\n                      <mj-column>\n                          <mj-image src=\"https://lh3.googleusercontent.com/d/1bveO7WYcxDDMgPJGCKniHpxKWUJkgDqf\" width=\"1000\" height=\"150\"/>\n                      </mj-column>\n                  </mj-section>\n                  <mj-divider  border-width=\"1px\" border-color=\"#D3D3D3\"/> \n                  <mj-wrapper>\n                      ${summary}\n                      <mj-section>\n                          <mj-column>\n                              ${issues.join(`<mj-divider  border-width=\"1px\" border-color=\"#D3D3D3\"/>`)}\n                          </mj-column>\n                      </mj-section>\n                  </mj-wrapper>\n          </mj-body>\n          </mjml>`\n  }"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        912,
        1104
      ],
      "id": "09339ec8-6306-4e73-b945-ac7f98840e26",
      "name": "convert MJML"
    },
    {
      "parameters": {
        "jsCode": "const mjml2html = require('mjml');\n  return {\n      htmlOutput: mjml2html($input.first().json.issueHTML)\n  }"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1136,
        1104
      ],
      "id": "78414a49-3a06-4416-b00e-09695a9b4977",
      "name": "convert MJML to HTML"
    },
    {
      "parameters": {
        "model": "google/gemini-2.0-flash-exp:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        344,
        1328
      ],
      "id": "5166ae3b-ef00-4bb5-8e9a-cb2608d6588d",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "qwen/qwen3-coder:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        472,
        1328
      ],
      "id": "15339e92-4499-477d-97f8-8e146ef207a1",
      "name": "OpenRouter Chat Fallback Model",
      "credentials": {
        "openRouterApi": {
          "id": "openRouterApi",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": ""
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -336,
        1104
      ],
      "id": "b0c87ce1-9c4b-4839-888a-334220da5734",
      "name": "Load Repo Info"
    },
    {
      "parameters": {
        "authentication": "headerAuth",
        "endpoint": "https://api.github.com/graphql",
        "query": "=\n    query {\n        repository(owner: \"{{ $json.owner }}\", name: \"{{ $json.name }}\") {\n            issues(first: 10, states: OPEN, orderBy: { field: CREATED_AT, direction: DESC }) {\n                nodes {\n                    title\n                    url\n                    body\n                    author {\n                        ... on User {\n                            login\n                        }\n                    }\n                    issueType {\n                        name\n                    }\n                    labels(first: 5) {\n                        edges {\n                            node {\n                                name\n                            }\n                        }\n                    }\n                    comments(first: 10) {\n                        nodes {\n                            body\n                        }\n                    }\n                }\n            }\n        }\n    }\n",
        "variables": "="
      },
      "type": "n8n-nodes-base.graphql",
      "typeVersion": 1.1,
      "position": [
        -112,
        1104
      ],
      "id": "04c3ca7a-fa69-45d7-9cd4-6e28e85842e1",
      "name": "Get Issue From Github",
      "credentials": {
        "httpHeaderAuth": {
          "id": "httpHeaderAuth",
          "name": "Header Auth account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "=define",
        "text": "=\n    {{ $json.markdown_list }}\n\n    Generate a YAML object from the markdown list above.\n",
        "needsFallback": true,
        "options": {
          "systemMessage": "=\n    You are a 10-year experienced developer with extensive open-source contribution experience, looking to contribute to open source.\n\n    Search the issues below, read their content, and classify them according to the criteria for good contribution opportunities below.\n    The URL for the issues is https://github.com/{{ $('Load Repo Info').first().json.repo}}/issues.\n    When classifying issues, evaluate them based on issue content, root cause, resolution approach, how well they meet the criteria (high, medium, low), and technical difficulty (high, medium, low).\n\n    [Criteria for good contribution opportunities]\n    Issues with detailed and well-written content.\n    Issues where bug or error logs and reproduction steps are clearly specified within the content.\n    Issues where the location of suspicious source code has been identified by the reporter or maintainer.\n    Issues where the maintainer has confirmed the problem, set a direction, or requested contributions.\n    Issues directly created by the maintainer.\n    Issues with a \"good first issue\" label and no \"blocked\" or \"wait-for-triage\" labels.\n    Issues for which a PR has not yet been created (it's okay if someone has only stated they will create a PR).\n\n    For issues that meet the above criteria well, explain and emphasize them in detail.\n    There is no need to summarize issues that do not meet the above criteria.\n    \n    Generate a YAML object that matches the TypeScript type $IssueCollection below:\n\n\t\tRules:\n    - Wrap every YAML list item in double quotes. Escape only double quotes (\") inside the string with a backslash (\").\n    - The summary should be a list of exactly three single sentences, where each sentence briefly highlights an issue suitable for today's contribution.\n    - From the issues that meet the criteria, provide a minimum of 3 and a maximum of 5 of the most suitable ones.\n    - Translate all user-facing string values (issueTitle, issueDescription, rootCause, all items in reasons arrays, and all summary strings) into the language specified by ko-KR. Do not translate the YAML keys.\n\n    type Level = \"high\" | \"medium\" | \"low\";\n\n    interface LevelWithReasons {\n        level: Level;\n        reasons: string[];\n    }\n\n    interface Issue {\n        issueTitle: string;\n        issueURL: string;\n        issueDescription: string;\n        rootCause: string;\n        resolutionApproach: string[];\n        issueSuitability: LevelWithReasons;\n        technicalDifficulty: LevelWithReasons;\n    }\n\n    interface IssueCollection {\n        issues: Issue[];\n        summary: string[];\n    }\n\n    ------------\n    Example output:\n    issues:\n    - issueTitle: |\n      ...\n      issueURL: \"https://example.com\"\n      issueDescription: |\n      ...\n      rootCause: |\n      ...\n      resolutionApproach:\n        - \"It's an \\\"approach1\\\"\"\n      issueSuitability:\n        level: \"medium\"\n        reasons:\n            - \"...\"\n      technicalDifficulty:\n        level: \"high\"\n        reasons:\n             - \"...\"\n    summary:\n      - \"...\"\n",
          "batching": {
            "delayBetweenBatches": 2
          }
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        336,
        1104
      ],
      "id": "9ca0496b-9938-466b-b159-164f72a2bc24",
      "name": "Process with AI",
      "retryOnFail": true
    },
    {
      "parameters": {
        "fromEmail": "",
        "toEmail": "",
        "subject": "Issue Report",
        "html": "={{ $json.htmlOutput.html }}",
        "options": {}
      },
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [
        1360,
        1104
      ],
      "id": "4fbe9184-c329-4691-9fcc-3061aaecdf57",
      "name": "Send email",
      "webhookId": "d1108327-f642-465e-81a5-bb8e25098f9f",
      "credentials": {
        "smtp": {
          "id": "smtp",
          "name": "SMTP account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Convert Markdown": {
      "main": [
        [
          {
            "node": "Process with AI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking ‚ÄòExecute workflow‚Äô": {
      "main": [
        [
          {
            "node": "Load Repo Info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "parse YAML": {
      "main": [
        [
          {
            "node": "convert MJML",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Process with AI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML": {
      "main": [
        [
          {
            "node": "convert MJML to HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "convert MJML to HTML": {
      "main": [
        [
          {
            "node": "Send email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Process with AI",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Fallback Model": {
      "ai_languageModel": [
        [
          {
            "node": "Process with AI",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Load Repo Info": {
      "main": [
        [
          {
            "node": "Get Issue From Github",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Issue From Github": {
      "main": [
        [
          {
            "node": "Convert Markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process with AI": {
      "main": [
        [
          {
            "node": "parse YAML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "3cff76c1-b680-40f3-b481-a0d579280652",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "c4eb748d1201f6efcf3fb4abe55ad9f6c4623960d681ba4f9bd76fc5b7ea8d40"
  },
  "tags": []
}
